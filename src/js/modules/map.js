export const map = () => {
    const mapBlock = document.getElementById("map");

    if (mapBlock) {
        ymaps.ready(init);

        var visibleAreas = true;
        let polygonArr = [];

        function init() {
            var myMap = new ymaps.Map(
                "map",
                {
                    center: [60.04632441862734, 30.345199728835954],
                    zoom: 9,
                    controls: [],
                },
                {
                    searchControlProvider: "yandex#search",
                }
            );

            var mark = new ymaps.Placemark(
                [60.04632441862734, 30.345199728835954],
                {},
                {
                    iconLayout: "default#image",
                    iconImageHref: "/img/placemark.svg",
                    iconImageSize: [60, 80],
                    iconImageOffset: [-34, -80],
                }
            );

            var polygon = new ymaps.Polygon(
                [
                    [
                        [60.02592167110275, 29.991577292312513],
                        [60.04660612643347, 29.97235121809376],
                        [60.07004850914161, 29.96411147200001],
                        [60.09624881922717, 29.96411147200001],
                        [60.1183122382466, 29.97784438215626],
                        [60.13899669357731, 30.010803366531263],
                        [60.13623876619988, 30.057495261062513],
                        [60.127964984067596, 30.109680319656263],
                        [60.12382809300146, 30.153625632156263],
                        [60.12520705669017, 30.197570944656263],
                        [60.134859802511166, 30.238769675125013],
                        [60.12658602037888, 30.282714987625013],
                        [60.11693327455789, 30.329406882156263],
                        [60.1086594924256, 30.370605612625013],
                        [60.08659607340618, 30.376098776687513],
                        [60.06591161807546, 30.398071432937513],
                        [60.04798509012218, 30.425537253250017],
                        [60.03281648954633, 30.458496237625017],
                        [60.013510997904326, 30.480468893875017],
                        [59.990068615196186, 30.505188132156267],
                        [59.973521050931616, 30.535400534500017],
                        [59.95145763191219, 30.546386862625017],
                        [59.92939421289277, 30.540893698562517],
                        [59.90595183018463, 30.538147116531267],
                        [59.8838884111652, 30.529907370437517],
                        [59.86871981058935, 30.496948386062517],
                        [59.85493017370221, 30.461242819656267],
                        [59.83838260943764, 30.431030417312517],
                        [59.85906706476835, 30.032776022781263],
                        [59.88113048378777, 30.005310202468763],
                        [59.903193902807196, 29.988830710281263],
                        [59.92387835813791, 29.97235121809376],
                        [59.94594177715734, 29.96411147200001],
                        [59.96938415986548, 29.96960463606251],
                        [59.9914475788849, 29.986084128250013],
                        [60.013510997904326, 29.988830710281263],
                        [60.03557441692375, 29.986084128250013],
                    ],
                ],
                {},
                {
                    strokeColor: "#319CFF",
                    strokeOpacity: 0.6,
                    strokeWidth: 6,
                    fillColor: "#319CFF",
                    fillOpacity: 0.3,
                }
            );

            var polygon2 = new ymaps.Polygon(
                [
                    [
                        [60.190772315394504, 29.835022116531253],
                        [60.15221764165628, 29.785583639968753],
                        [60.108155157384026, 29.747131491531253],
                        [60.06409267311177, 29.725158835281253],
                        [60.02003018883951, 29.719665671218753],
                        [59.97321379930025, 29.719665671218753],
                        [59.92915131502799, 29.730651999343753],
                        [59.885088830755734, 29.758117819656253],
                        [59.84102634648348, 29.802063132156253],
                        [59.80797948327929, 29.862487936843753],
                        [59.783194335876146, 29.95037856184375],
                        [59.76667090427405, 30.04376235090625],
                        [59.750147472671955, 30.14813246809375],
                        [59.739131851603894, 30.24700942121875],
                        [59.73362404106986, 30.35137953840625],
                        [59.72811623053583, 30.43927016340625],
                        [59.72811623053583, 30.54364028059375],
                        [59.72811623053583, 30.63702406965625],
                        [59.72811623053583, 30.73040785871875],
                        [59.73637794633687, 30.81829848371875],
                        [59.750147472671955, 30.90618910871875],
                        [59.772178714808085, 30.98309340559375],
                        [59.81624119908034, 31.03253188215625],
                        [59.87131930442066, 31.03253188215625],
                        [59.90987397815888, 30.98858656965625],
                        [59.9484286518971, 30.93914809309375],
                        [59.992491136169356, 30.96661391340625],
                        [60.033799715174595, 31.02703871809375],
                        [60.06684657837879, 30.96661391340625],
                        [60.11366296791805, 30.93365492903125],
                        [60.15772545219031, 30.92816176496875],
                        [60.201787936462566, 30.90618910871875],
                        [60.240342610200784, 30.86224379621875],
                        [60.284405094473044, 30.84027113996875],
                        [60.30092852607514, 30.75787367903125],
                        [60.29817462080812, 30.65899672590625],
                        [60.317451957677235, 30.57110610090625],
                        [60.33397538927933, 30.48870863996875],
                        [60.32295976821126, 30.39532485090625],
                        [60.356006631415454, 30.32940688215625],
                        [60.317451957677235, 30.28546156965625],
                        [60.27889728393901, 30.23602309309375],
                        [60.273389473404976, 30.13714613996875],
                        [60.27889728393901, 30.03826918684375],
                        [60.27889728393901, 29.939392233718753],
                        [60.25686604180288, 29.862487936843753],
                        [60.21280355753063, 29.835022116531253],
                    ],
                ],
                {},
                {
                    strokeColor: "#ff0000",
                    strokeOpacity: 0.6,
                    strokeWidth: 6,
                    fillColor: "#ff0000",
                    fillOpacity: 0.1,
                }
            );

            polygon.options.set("visible", visibleAreas);
            polygon2.options.set("visible", visibleAreas);

            myMap.geoObjects.add(polygon);
            myMap.geoObjects.add(polygon2);
            myMap.geoObjects.add(mark);

            polygonArr.push(polygon, polygon2);
        }

        const mapCheckbox = document.getElementById("map-areas");

        if (mapCheckbox) {
            mapCheckbox.addEventListener("change", (e) => {
                const target = e.target;

                visibleAreas = target.checked;

                polygonArr.forEach((polygon) => {
                    polygon.options.set("visible", visibleAreas);
                });
            });
        }
    }
};
